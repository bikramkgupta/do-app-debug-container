# Example: Add debug container to an existing App Platform application
#
# Add this worker component to your existing app.yaml to deploy the debug
# container alongside your main application. This allows you to:
#
# 1. Test database connectivity from within App Platform's network
# 2. Debug DNS resolution issues
# 3. Test connectivity to external services
# 4. Access the container shell via `doctl apps console` or do-app-sandbox SDK
#
# IMPORTANT: This is a WORKER (not a service), so it doesn't have a public URL.
# Access it via console/shell to run diagnostics.

# Add this to your existing app.yaml under 'services' or 'workers':

workers:
  - name: debug
    dockerfile_path: Dockerfile
    github:
      repo: bikramkgupta/do-app-debug-container
      branch: main
      deploy_on_push: false
    instance_size_slug: basic-xxs
    instance_count: 1

    # Connect to your existing database
    envs:
      - key: DATABASE_URL
        scope: RUN_TIME
        value: ${db.DATABASE_URL}
      # Add other env vars as needed:
      # - key: REDIS_URL
      #   scope: RUN_TIME
      #   value: ${redis.REDIS_URL}

# If you want it as a service with HTTP access (for API diagnostics):
# services:
#   - name: debug
#     dockerfile_path: Dockerfile
#     github:
#       repo: bikramkgupta/do-app-debug-container
#       branch: main
#     instance_size_slug: basic-xxs
#     instance_count: 1
#     http_port: 8080
#     routes:
#       - path: /debug
#     envs:
#       - key: DATABASE_URL
#         scope: RUN_TIME
#         value: ${db.DATABASE_URL}
